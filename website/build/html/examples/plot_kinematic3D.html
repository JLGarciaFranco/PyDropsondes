

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Plot vorticity and divergence in 3D views &mdash; PyDropsondes 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyDropsondes 1 documentation" href="../index.html"/>
        <link rel="up" title="Gallery of Examples" href="../gallery.html"/>
        <link rel="next" title="Evaluate gradient wind balance and momentum!" href="plot_gradwindbalanc.html"/>
        <link rel="prev" title="Plot the wind and temperature structure of a TC" href="plot_winds_temp.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../home.html" class="icon icon-home"> PyDropsondes
          

          
          </a>

          
            
            
              <div class="version">
                1.
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../interface.html">The Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flight.html">Flightdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process.html">Process Dropsondes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">The Toolbox</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gallery.html">Gallery of Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plotrack.html">1. Plotting the track of a Tropical Cyclone</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_intensity_series.html">2. Plotting the intensity metrics of a Tropical Cyclone</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_drift_dropsondes.html">3. Plot the drift of all dropsondes for a TC</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_winds_temp.html">Plot the wind and temperature structure of a TC</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plot vorticity and divergence in 3D views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#computation-of-vorticity-and-divergence">Computation of vorticity and divergence.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-section">Cross section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plan-views">Plan views</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expected-cross-sections-for-rita-in-september-21-2005">Expected cross sections for Rita in September 21, 2005 :</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expected-plan-views-for-rita-in-september-21-2005">Expected plan views for Rita in September 21, 2005 :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_gradwindbalanc.html">Evaluate gradient wind balance and momentum!</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_cape.html">Plot CAPE distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery.html#examples-for-dummies">Examples for Dummies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery.html#intermediate-examples">Intermediate examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../home.html">PyDropsondes</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../home.html">Docs</a> &raquo;</li>
        
          <li><a href="../gallery.html">Gallery of Examples</a> &raquo;</li>
        
      <li>Plot vorticity and divergence in 3D views</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/plot_kinematic3D.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plot-vorticity-and-divergence-in-3d-views">
<span id="sphx-glr-auto-examples-plot-kinematic3d-py"></span><h1>Plot vorticity and divergence in 3D views<a class="headerlink" href="#plot-vorticity-and-divergence-in-3d-views" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>One of the most important kinematic metrics are vorticity and divergence. Both
directly related to the first spatial derivative of the wind components.</p>
<p>As such, the definitions used therein are:</p>
<div class="math">
\[\hat{\eta}=\nabla\times\vec{u}=(\eta_{\hat{i}},\eta_{\hat{j}},\eta_{\hat{k}})\]</div>
<p>where <span class="math">\(\hat{\eta}\)</span> is the three-dimensional vorticity vector and <span class="math">\(\eta_{\hat{k}}\)</span> is the vertical component of the vorticity.
In general, the <span class="math">\(\hat{i}\)</span> and <span class="math">\(\hat{j}\)</span> components of the vorticity are usually ignored given the small variation of u and v on the z axis and the
small scale of the vertical component of the velocity and therefore its small gradient across all axis.</p>
<p>Hereafter we will refer to the vertical component of vorticity as simply vorticity and it is given as:</p>
<div class="math">
\[\eta_{\hat{k}}=\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}\]</div>
<p>Similarly, the divergence of the wind field is classically defined as:</p>
<div class="math">
\[\nabla \cdot \vec{u} = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>This example is not documented in-line but it is rather explained through the Sphinx-Gallery pages, i.e., through this text floating around
on top of the text-block. This allows to have short but explained example files.</div></blockquote>
<p class="last">Also noteworthy is the use of <a class="reference external" href="https://unidata.github.io/MetPy/latest/index.html">Metpy</a> algorithm (although not the actual script) to compute these variables.</p>
</div>
<p>The first section of this example includes the preamble, which is highly documented in <code class="xref py py-meth docutils literal"><span class="pre">sphx_glr_auto_examples_plot_drift_dropsondes.py()</span></code> and <a class="reference internal" href="../process.html#module-processing" title="processing"><code class="xref py py-meth docutils literal"><span class="pre">processing()</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Preamble</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">toolbox</span> <span class="kn">import</span> <span class="n">convergence_vorticity</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
</pre></div>
</div>
</div>
<dl class="docutils">
<dt>The example is based on reading-in the outputfile of the module <a class="reference internal" href="../process.html#module-processing" title="processing"><code class="xref py py-meth docutils literal"><span class="pre">processing()</span></code></a>, just as <a class="reference internal" href="plot_winds_temp.html#sphx-glr-auto-examples-plot-winds-temp-py"><span class="std std-ref">Plot the wind and temperature structure of a TC</span></a> is,</dt>
<dd>which is a temporary file written by the external Julia routine. The file is then imported as a numpy array through the function np.genfromtxt.</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Read-in file and allocate fields.</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">storm</span><span class="o">=</span><span class="s1">&#39;Rita&#39;</span>
<span class="n">sdate</span><span class="o">=</span><span class="s1">&#39;15_21-1_22&#39;</span>

<span class="n">matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">storm</span><span class="o">+</span><span class="n">sdate</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span>
<span class="n">radius</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Height</span><span class="o">=</span><span class="n">H</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">u_cartesian</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">v_cartesian</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">u_radial</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
<span class="n">v_tang</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">x</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
<span class="n">pressure</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">thetas</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The following block sets-up the rest of the example by first defining the variables storm and stormdate (sdate).
Given that this script is originally meant to be run by the <code class="xref py py-meth docutils literal"><span class="pre">interface()</span></code>,
it has two system arguments, i.e., strings provided by either the user or the outer script.
These two parameters are the storm name and the date of the measurement. This can be provided by the user as in this example.
After allocating these parameters, the figure directory is defined but it can be changed and adapted to user’s os.
Next, the initial interpolation grid in 3D through xi,yi and height_vec.
Finally, the vorticity and divergence arrays are constructed based on the size of our 3d interpolation grid.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>User can modify and tamper the figure directory to select the directory of their choice.</div></blockquote>
<p class="last">In the documented Sphinx-script, a slightly different approach was used to first, define the storm’s name and date and then use an output file for this script.
Reader is advised to compare and contrast documented and operational versions. The version in this example is then deprecated from the DVT.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Set-up</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">#storm=sys.argv[1]</span>
<span class="c1">#sdate=sys.argv[2]</span>
<span class="n">storm</span><span class="o">=</span><span class="s1">&#39;Earl&#39;</span>
<span class="n">sdate</span><span class="o">=</span><span class="s1">&#39;01-09-2010&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">sdate</span><span class="p">)</span>
<span class="n">figdir</span><span class="o">=</span><span class="s1">&#39;/home/jlgf/Documents/MRes/Project/figs/&#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
<span class="n">xi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">yi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">height_vec</span><span class="o">=</span><span class="n">Hi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">2800</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">vorticity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">yi</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Hi</span><span class="p">)))</span>
<span class="n">divergence</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">yi</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Hi</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="computation-of-vorticity-and-divergence">
<h2>Computation of vorticity and divergence.<a class="headerlink" href="#computation-of-vorticity-and-divergence" title="Permalink to this headline">¶</a></h2>
<p>The following block is a for-loop to iterate over all height values in the height vector.
At each step, this loop obtains the indexes (indices) where u and v components of the velocity are located in the height window.
Similarly, x and y are sliced to obtain the locations of the u and v observations.</p>
<p>After slicing <code class="xref py py-meth docutils literal"><span class="pre">toolbox.convergence_vorticity()</span></code> is called and used to provide vorticity and divergence fields in the Horizontal grid.
These are then allocated in the 3D arrays defined above.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Interpolation and allocation of kinematic fields</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ij</span><span class="p">,</span><span class="n">H0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">height_vec</span><span class="p">):</span>
   <span class="k">try</span><span class="p">:</span>
       <span class="n">indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">H</span><span class="o">&gt;=</span><span class="n">H0</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">H</span><span class="o">&lt;</span><span class="n">H0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
       <span class="n">u_xh</span><span class="o">=</span><span class="n">griddata</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">]),</span><span class="n">u_cartesian</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">yi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">v_xh</span><span class="o">=</span><span class="n">griddata</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">]),</span><span class="n">v_cartesian</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">yi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
   <span class="k">except</span><span class="p">:</span>
       <span class="n">vorticity</span><span class="p">[:,:,</span><span class="n">ij</span><span class="p">]</span><span class="o">=</span><span class="n">divergence</span><span class="p">[:,:,</span><span class="n">ij</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
       <span class="k">continue</span>
   <span class="n">nabla_dot_u</span><span class="p">,</span><span class="n">nabla_cross_u</span><span class="o">=</span><span class="n">convergence_vorticity</span><span class="p">(</span><span class="n">u_xh</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">meters</span><span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">seconds</span><span class="p">,</span><span class="n">v_xh</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">meters</span> <span class="o">/</span><span class="n">units</span><span class="o">.</span><span class="n">seconds</span><span class="p">,</span><span class="mi">10000</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">meters</span><span class="p">,</span><span class="mi">10000</span><span class="o">*</span><span class="n">units</span><span class="o">.</span><span class="n">meters</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">dim_order</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
   <span class="n">vorticity</span><span class="p">[:,:,</span><span class="n">ij</span><span class="p">]</span><span class="o">=</span><span class="n">nabla_cross_u</span><span class="o">*</span><span class="mi">100</span>
   <span class="n">divergence</span><span class="p">[:,:,</span><span class="n">ij</span><span class="p">]</span><span class="o">=</span><span class="n">nabla_dot_u</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<p>After creating the proper fields, two different plots will be produced, as in <a class="reference internal" href="plot_winds_temp.html#sphx-glr-auto-examples-plot-winds-temp-py"><span class="std std-ref">Plot the wind and temperature structure of a TC</span></a>: cross sections and plan views.</p>
</div>
<div class="section" id="cross-section">
<h2>Cross section<a class="headerlink" href="#cross-section" title="Permalink to this headline">¶</a></h2>
<p>The cross section plot is similarly constructed to other examples, although this are not r-H axisymmetrical view points but
North-South and East-West cross sections.
This code-block (chronologically) creates the figure object, allocates subplots and contourplots with specified levels and color maps.
Notice two things, first, these cross sections are based on where y and x are 0, which provides the sense of the N-S and E-W cross sections.
Similarly, this block does not make use of dictionaries for code simplicity but rather makes explicitly each plot.
Several reasons for this decision but the main rationale is that code clarity would be severly tampered if the block was based on a dictionary loop as in
<a class="reference internal" href="plot_winds_temp.html#sphx-glr-auto-examples-plot-winds-temp-py"><span class="std std-ref">Plot the wind and temperature structure of a TC</span></a> while gaining only little space.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Cross section plot.</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">Hi</span><span class="p">,</span><span class="n">vorticity</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yi</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">vorticity</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vorticity</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
<span class="c1">#plt.colorbar(CS)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2800</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical vorticity W-E Height Cross section&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span><span class="n">Hi</span><span class="p">,</span><span class="n">vorticity</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xi</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],:,:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">vorticity</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vorticity</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$10^{-2}$s$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2800</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical vorticity N-S Height Cross section&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span><span class="n">Hi</span><span class="p">,</span><span class="n">divergence</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yi</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">divergence</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">divergence</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
<span class="c1">#plt.colorbar(CS)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2800</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Horizontal divergence W-E Height Cross section&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span><span class="n">Hi</span><span class="p">,</span><span class="n">divergence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xi</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],:,:]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">divergence</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">divergence</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$10^{-2}$s$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2800</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Horizontal divergence N-S Height Cross section&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Kinematic plots for &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="n">sdate</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span><span class="o">+</span><span class="s1">&#39;axisym/kinematic&#39;</span><span class="o">+</span><span class="n">sdate</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The final part of this exercise is to define the title, based on the storm’s name and date and save the figure.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Save and show</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Kinematic plots for &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="n">sdate</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figs/kinematic&#39;</span><span class="o">+</span><span class="n">sdate</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plan-views">
<h2>Plan views<a class="headerlink" href="#plan-views" title="Permalink to this headline">¶</a></h2>
<p>Plan views refer to a plot that shows the horizontal structure as viewed from above in the z-axis.
In other words, we take all points in a particular height and compute interpolated horizontal grids.</p>
<p>The first block includes the set-up of the plot by defining the levels where plan views will be plotted (heights) and
creating the figure objects.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Planview set-up.</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Heights</span><span class="o">=</span><span class="p">[</span><span class="mi">150</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>After this, a for-loop structure is written to iterate over all heights specified in the Heights list.
Inside this loop, vorticity and divergence fields are sliced using a similar syntax as the cross sections by finding the index where the height vector
has the specified height.</p>
<p>In this case, the for loop is used for compression, plotting vorticity in the upper panels and divergence in the lower panels.
We acknowledge the subplot syntax is not trivial and indeed can be subject to questions when compressed as below. See <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html">subplots</a>
for details.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">height loop</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">height</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Heights</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">241</span><span class="o">+</span><span class="n">index</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">vorticity</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hi</span><span class="o">==</span><span class="n">height</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">vorticity</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hi</span><span class="o">==</span><span class="n">height</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vorticity</span><span class="p">),</span><span class="mi">12</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="c1">#plt.colorbar(CS)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$10^{-2}$s$^{-1}$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical vorticity at &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">245</span><span class="o">+</span><span class="n">index</span><span class="p">)</span>
    <span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">divergence</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hi</span><span class="o">==</span><span class="n">height</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">divergence</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hi</span><span class="o">==</span><span class="n">height</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">divergence</span><span class="p">),</span><span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;s$^{-1}$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Horizontal divergence at &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; m&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally the plot needs a title, shown and saved.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Save and show.</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Kinematic plots for &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="n">sdate</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figs/kinematic&#39;</span><span class="o">+</span><span class="n">sdate</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="expected-cross-sections-for-rita-in-september-21-2005">
<h2>Expected cross sections for Rita in September 21, 2005 :<a class="headerlink" href="#expected-cross-sections-for-rita-in-september-21-2005" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/kinematic15_21-1_22.png" class="sphx-glr-single-img" src="../_images/kinematic15_21-1_22.png" />
</div>
<div class="section" id="expected-plan-views-for-rita-in-september-21-2005">
<h2>Expected plan views for Rita in September 21, 2005 :<a class="headerlink" href="#expected-plan-views-for-rita-in-september-21-2005" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/plankinematic15_21-1_22.png" class="sphx-glr-single-img" src="../_images/plankinematic15_21-1_22.png" />
<p>This script can be used by both inserting in the interface the name of storm and selecting the option create plots of the 3D kinematic structure.
Similarly, this script can be used individually if the storm name, date and the filename are specified in the second block of this example.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_gradwindbalanc.html" class="btn btn-neutral float-right" title="Evaluate gradient wind balance and momentum!" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_winds_temp.html" class="btn btn-neutral" title="Plot the wind and temperature structure of a TC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Garcia-Franco J.L..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>