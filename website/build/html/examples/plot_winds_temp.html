

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Plot the wind and temperature structure of a TC &mdash; PyDropsondes 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyDropsondes 1 documentation" href="../index.html"/>
        <link rel="up" title="Gallery of Examples" href="../gallery.html"/>
        <link rel="next" title="Plot vorticity and divergence in 3D views" href="plot_kinematic3D.html"/>
        <link rel="prev" title="3. Plot the drift of all dropsondes for a TC" href="plot_drift_dropsondes.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../home.html" class="icon icon-home"> PyDropsondes
          

          
          </a>

          
            
            
              <div class="version">
                1.
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../interface.html">The Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flight.html">Flightdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process.html">Process Dropsondes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">The Toolbox</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gallery.html">Gallery of Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plotrack.html">1. Plotting the track of a Tropical Cyclone</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_intensity_series.html">2. Plotting the intensity metrics of a Tropical Cyclone</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_drift_dropsondes.html">3. Plot the drift of all dropsondes for a TC</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plot the wind and temperature structure of a TC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cross-sections">Cross sections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plan-views">Plan views</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expected-cross-sections-for-rita-in-september-21-2005">Expected cross sections for Rita in September 21, 2005 :</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expected-plan-views-for-rita-in-september-21-2005">Expected plan views for Rita in September 21, 2005 :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_kinematic3D.html">Plot vorticity and divergence in 3D views</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_gradwindbalanc.html">Evaluate gradient wind balance and momentum!</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_cape.html">Plot CAPE distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery.html#examples-for-dummies">Examples for Dummies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery.html#intermediate-examples">Intermediate examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../home.html">PyDropsondes</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../home.html">Docs</a> &raquo;</li>
        
          <li><a href="../gallery.html">Gallery of Examples</a> &raquo;</li>
        
      <li>Plot the wind and temperature structure of a TC</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/plot_winds_temp.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plot-the-wind-and-temperature-structure-of-a-tc">
<span id="sphx-glr-auto-examples-plot-winds-temp-py"></span><h1>Plot the wind and temperature structure of a TC<a class="headerlink" href="#plot-the-wind-and-temperature-structure-of-a-tc" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="docutils">
<dt>This example will plot the cylindrical-coordinate system winds and temperature fields, i.e.,</dt>
<dd>radial <span class="math">\(\frac{\partial r}{\partial t}\)</span> and azimuthal <span class="math">\(\frac{\partial \Theta}{\partial t}\)</span> wind speeds and
the potential temperature (<span class="math">\(\theta\)</span>) and the equivalent potential temperature (<span class="math">\(\theta_e\)</span>).</dd>
</dl>
<p>As such, this example is closely related to several functions in the toolbox, mainly:
<a class="reference internal" href="../tools.html#toolbox.cart_to_cylindr" title="toolbox.cart_to_cylindr"><code class="xref py py-meth docutils literal"><span class="pre">toolbox.cart_to_cylindr()</span></code></a>, <a class="reference internal" href="../tools.html#toolbox.potential_temperature" title="toolbox.potential_temperature"><code class="xref py py-meth docutils literal"><span class="pre">toolbox.potential_temperature()</span></code></a> and <a class="reference internal" href="../tools.html#toolbox.equivalent_potential_temperature" title="toolbox.equivalent_potential_temperature"><code class="xref py py-meth docutils literal"><span class="pre">toolbox.equivalent_potential_temperature()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example is not documented-inline but it is rather explained through the Sphinx-Gallery pages, i.e., through this text floating around
on top of the text-block. This allows to have short but explained example files.</p>
</div>
<p>The first section of this example includes the preamble, which is highly documented in <code class="xref py py-meth docutils literal"><span class="pre">_sphx_glr_auto_examples_plot_drift.py()</span></code> and <a class="reference internal" href="../process.html#module-processing" title="processing"><code class="xref py py-meth docutils literal"><span class="pre">processing()</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Preamble</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
</pre></div>
</div>
</div>
<p>The example is based on reading-in the outputfile of the module <a class="reference internal" href="../process.html#module-processing" title="processing"><code class="xref py py-meth docutils literal"><span class="pre">processing()</span></code></a> which is a temporary file written by the
external Julia routine. The file is then imported as a numpy array through the function np.genfromtxt.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Read-in file and allocate fields.</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;tempjulia.txt&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">H</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">u_radial</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
<span class="n">v_tang</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">x</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">13</span><span class="p">]</span>
<span class="n">temperature</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">thetae</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">thetas</span><span class="o">=</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Given that this script is originally meant to be run by the <code class="xref py py-meth docutils literal"><span class="pre">interface()</span></code>, it has two system arguments, i.e., strings provided by either the user or
the outer script. These two parameters are the storm name and the date of the measurement. This can be provided by the user.
After allocating these parameters, the figure directory is defined but it can be changed and adapted to user’s os.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User can modify and tamper the figure directory to select the directory of their choice.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Set-up</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">#storm=sys.argv[1]</span>
<span class="c1">#sdate=sys.argv[2]</span>
<span class="n">storm</span><span class="o">=</span><span class="s1">&#39;Rita&#39;</span>
<span class="n">sdate</span><span class="o">=</span><span class="s1">&#39;2005-09-20&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">sdate</span><span class="p">)</span>
<span class="n">figdir</span><span class="o">=</span><span class="s1">&#39;/home/jlgf/Documents/MRes/Project/figs/&#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="cross-sections">
<h2>Cross sections<a class="headerlink" href="#cross-sections" title="Permalink to this headline">¶</a></h2>
<p>Axisymmetric cross sections are typical plots used to observe the structure of a Tropical Cyclone. In particular,
this type of plots rely on the notion that these convective systems are symmetric with respect to their centre. In other words, at the same radius (<span class="math">\(r\)</span>) most properties will have the same magnitude.</p>
<p>In other words, these cross sections are radius-height (r-H) cross sections.
To produce this r-H plots, interpolation of the dropsonde observations is needed. For that reason we imported the griddata function from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">scipy</a>.
The following block does the interpolation.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Interpolation</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span>       <span class="c1">#interpolation grid</span>
       <span class="n">ri</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
       <span class="n">Hi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">3200</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
       <span class="c1">#interpolation fields.</span>
       <span class="n">mean_azi</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">H</span><span class="p">),</span><span class="n">v_tang</span><span class="p">,</span> <span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">Hi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">mean_radial</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">H</span><span class="p">),</span><span class="n">u_radial</span><span class="p">,</span> <span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">Hi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">mean_temp</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">H</span><span class="p">),</span><span class="n">temperature</span><span class="p">,</span> <span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">Hi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
       <span class="n">mean_vert</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">r</span><span class="p">,</span><span class="n">H</span><span class="p">),</span><span class="n">thetae</span><span class="p">,</span> <span class="p">(</span><span class="n">ri</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">Hi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After producing interpolated fields for the cross sections, creating the figure is the next step.
In this case, we produce a figure with 4 subplots (2x2) that will allocate radial and azimuthal winds on the upper panel and potential temperature and equivalent potential temperature on the lower panel.
Similarly, lists to customize plots are created. Labels and spacing of the contour levels are an example of the mentioned lists.
Notice how the syntax of the following block is centered around a for-loop to provide brevity to this example.
Also noteworthy is the commented line of a scatter plot. This plot will visually show where the dropsonde measurements are located in this plot, a crucial part since this is an interpolated plot and
interpretation should always be subject to data coverage.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Cross section plot.</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plottingdictionary</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Radial wind&quot;</span><span class="p">:</span><span class="n">mean_radial</span><span class="p">,</span><span class="s2">&quot;Azimuthal wind&quot;</span><span class="p">:</span><span class="n">mean_azi</span><span class="p">,</span><span class="s2">&quot;Potential temperature&quot;</span><span class="p">:</span><span class="n">mean_temp</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\theta_e$&quot;</span><span class="p">:</span><span class="n">mean_vert</span><span class="p">}</span>
<span class="n">colormaps</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;m s$^{-1}$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;m s$^{-1}$&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">]</span>
<span class="n">spacing</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">plottingdictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">field</span><span class="o">=</span><span class="n">plottingdictionary</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="o">+</span><span class="n">counter</span><span class="p">)</span>
        <span class="n">CS</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span><span class="n">Hi</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colormaps</span><span class="p">[</span><span class="n">counter</span><span class="p">],</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">field</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">spacing</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">field</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">spacing</span><span class="p">[</span><span class="n">counter</span><span class="p">]),</span><span class="n">spacing</span><span class="p">[</span><span class="n">counter</span><span class="p">]))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Radius [km] &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height [m] &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#       ax.scatter(r,H,color=&#39;black&#39;,s=1)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">counter</span><span class="p">])</span>
        <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<p>The final part of this exercise is to define the title, based on the storm’s name and date.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Save and show</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39; Cross sections of &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sdate</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">crossect_nolines</span><span class="s1">&#39;+str(sdate)+&#39;</span><span class="o">.</span><span class="n">png</span><span class="s1">&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plan-views">
<h2>Plan views<a class="headerlink" href="#plan-views" title="Permalink to this headline">¶</a></h2>
<p>Plan views refer to a plot that shows the horizontal structure as viewed from above in the z-axis.
In other words, we take all points in a particular height and compute interpolated horizontal grids.</p>
<p>The first block includes the set-up of the plot by defining the levels where plan views will be plotted (heights) and
creating the figure objects. Also in this block, the definition of the new grid for the interpolated grid is defined.
Notice that these values (-75,75) could set-up differently for different storms and that the spacing is equal to 2 km.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Planview set-up.</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">heights</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="n">figwinds</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">figtemps</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">xi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">yi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After this, another for-loop structure is written to iterate over all heights specified in the heights list.
Inside this loop, indices is the main tool since it locates all the indexes where the fields must be sliced.
This variable finds all the required values that meet the height requirements. In other words, out of the large array
imported from the text-file, this tool rapidly selects all the values that are within a given height zone.
In this case, a 80 m window was chosen to find the heights in this section.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">height loop</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">counter</span><span class="p">,</span><span class="n">hh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">heights</span><span class="p">):</span>

        <span class="n">indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">H</span><span class="o">&gt;</span><span class="n">hh</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">H</span><span class="o">&lt;</span><span class="n">hh</span><span class="o">+</span><span class="mi">40</span><span class="p">))</span>
        <span class="n">shortx</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">shorty</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">spacing</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>A second loop is required to effectively fill the figures objects with the plan views of all fields.
The first line of this block is the definition of the dictionary, filled with the large arrays read-in from the text-file.
Subsequently, there is a figure selection that depends on the chose field. Notice the loop is in place
so as to save space since most of the processing and interpolation is roughly the same for all fields.
The following block roughly interpolates and plots the plan views while setting-up the title and colorbar labels.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Dictionary loop.</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plottingdictionary</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Radial wind&quot;</span><span class="p">:</span><span class="n">u_radial</span><span class="p">,</span><span class="s2">&quot;Azimuthal wind&quot;</span><span class="p">:</span><span class="n">v_tang</span><span class="p">,</span><span class="s2">&quot;Potential temperature&quot;</span><span class="p">:</span><span class="n">temperature</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;$\theta_e$&quot;</span><span class="p">:</span><span class="n">thetae</span><span class="p">}</span>
<span class="k">for</span> <span class="n">incounter</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plottingdictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;Radial wind&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">figwinds</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">241</span><span class="o">+</span><span class="n">counter</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Azimuthal wind&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">figwinds</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">245</span><span class="o">+</span><span class="n">counter</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;Potential temperature&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">figtemps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">241</span><span class="o">+</span><span class="n">counter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">figtemps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">245</span><span class="o">+</span><span class="n">counter</span><span class="p">)</span>
        <span class="n">sliced_var</span><span class="o">=</span><span class="n">plottingdictionary</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">interp_var</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">shortx</span><span class="p">,</span><span class="n">shorty</span><span class="p">),</span><span class="n">sliced_var</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="bp">None</span><span class="p">,:],</span> <span class="n">yi</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s2">&quot;Radial wind&quot;</span> <span class="ow">and</span> <span class="n">hh</span> <span class="o">&lt;</span><span class="mi">500</span><span class="p">:</span>
                <span class="n">levelss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">interp_var</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">interp_var</span><span class="p">))</span><span class="o">+</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">],</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="n">levelss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">interp_var</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">interp_var</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">])),</span><span class="n">spacing</span><span class="p">[</span><span class="n">incounter</span><span class="p">])</span>
        <span class="n">cs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">interp_var</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colormaps</span><span class="p">[</span><span class="n">incounter</span><span class="p">],</span><span class="n">levels</span><span class="o">=</span><span class="n">levelss</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">key</span><span class="o">+</span><span class="s1">&#39; at &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">hh</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; m&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After the figure objects have been properly filled, the next and final block should add the figure titles, save and show the outcome.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Save and show.</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">figwinds</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plan views of cylindrical winds of &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sdate</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="n">figtemps</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Plan views of temperature fields of &#39;</span><span class="o">+</span><span class="n">storm</span><span class="o">+</span><span class="s1">&#39; on &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sdate</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="n">figwinds</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span><span class="o">+</span><span class="s1">&#39;planviews/winds_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sdate</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
<span class="n">figtemps</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span><span class="o">+</span><span class="s1">&#39;planviews/temps_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sdate</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="expected-cross-sections-for-rita-in-september-21-2005">
<h2>Expected cross sections for Rita in September 21, 2005 :<a class="headerlink" href="#expected-cross-sections-for-rita-in-september-21-2005" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/crossect_nolines21-09-2005.png" class="sphx-glr-single-img" src="../_images/crossect_nolines21-09-2005.png" />
</div>
<div class="section" id="expected-plan-views-for-rita-in-september-21-2005">
<h2>Expected plan views for Rita in September 21, 2005 :<a class="headerlink" href="#expected-plan-views-for-rita-in-september-21-2005" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/winds_21-09-2005.png" class="sphx-glr-single-img" src="../_images/winds_21-09-2005.png" />
<img alt="../_images/temps_21-09-2005.png" class="sphx-glr-single-img" src="../_images/temps_21-09-2005.png" />
<p>This script can be used by both inserting in the interface the name of storm and selecting the option to do the</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_kinematic3D.html" class="btn btn-neutral float-right" title="Plot vorticity and divergence in 3D views" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_drift_dropsondes.html" class="btn btn-neutral" title="3. Plot the drift of all dropsondes for a TC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Garcia-Franco J.L..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>